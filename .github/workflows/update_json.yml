name: Automated JSON File Generation

# Defines when this workflow should run
on:
  # 1. Schedule for automatic execution (The core requirement: running every hour)
  schedule:
    # This cron expression '0 * * * *' means "At minute 0 of every hour, every day, every month, every day of the week."
    - cron: '0 * * * *'
  # 2. Allows manual trigger from the Actions tab on GitHub
  workflow_dispatch:

# Defines the jobs (tasks) to be run
jobs:
  generate_files:
    # Specifies the type of runner (virtual machine) to use
    runs-on: ubuntu-latest
    
    # Define the sequential steps within the job
    steps:
      # Step 1: Check out the repository
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          # This token is automatically generated by GitHub and gives the workflow permission to read and write files.
          token: ${{ secrets.GITHUB_TOKEN }} 
      
      # Step 2: Set up the Python environment
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          # Use a stable version of Python 3
          python-version: '3.x'
          
      # Step 3: Execute the JSON processing script
      - name: Run JSON processing script
        # Executes the 'process_json.py' file located in the repository root
        run: python process_json.py
        
      # Step 4: Commit and Push the newly generated JSON files
      - name: Commit and Push generated files
        # Uses a third-party action to handle git commands automatically
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          # Specifies which files to commit. The wildcard '24spn-*.json' includes:
          # - 24spn-Football.json
          # - 24spn-Cricket.json
          # - 24spn-Kabaddi.json
          file_pattern: '24spn-*.json' 
          commit_message: 'Automated update: Regenerated category JSON files'
          # Customize the commit author information for clear history
          commit_user_name: 'GitHub Actions Bot'
          commit_user_email: 'actions@github.com'
